from cve_api_search import search_vulnerabilities
from web_scraper import scrape_extra_cve_info

def display_results(vuln_list):
    for vuln in vuln_list:
        print("\n==========================")
        print(f"🆔 CVE ID: {vuln['id']}")
        print(f"📝 Title: {vuln['title']}")
        print(f"📊 CVSS Score: {vuln['cvss']}")
        
        summary = scrape_extra_cve_info(vuln['id'])
        print(f"📃 Summary: {summary}")

if __name__ == "__main__":
    user_input = input("Enter service name, port, attack type or CVE ID: ").strip()

    vulns = search_vulnerabilities(user_input)

    if vulns:
        display_results(vulns[:5])
    else:
        print("❌ No vulnerabilities found.")